name: Check Models

on: 
  pull_request:
    paths:
      - 'models/**'

jobs:
  check-models:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          
      - name: Fetch base branch
        run: git fetch origin ${{ github.base_ref }}

      - name: Check for deleted or renamed models and its properties and fields of local branch to main branch
        run: |
          git diff --name-only --diff-filter=D origin/${{ github.base_ref }} | grep -E '^models/' | while read file; do
            if [ -f "$file" ]; then
              echo "File $file has been deleted or renamed."
            fi
          done || true
              
      - name: Passed 
        run: echo "All checks passed. No models were modified or deleted, and no lines were removed or changed in added/renamed files."
        if: success()
        
      - name: Failed
        run: echo "Checks failed. Please review the modified or deleted models and ensure no lines were removed or changed in added/renamed files."
        if: failure()  